{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block content %}
<div class="module">
    <h2>Run Mid-Season Fantasy Draft</h2>
    <div class="description">
        <p>
            This will execute the selected mid-season draft window for the league. The draft will assign players based on:
            <ul>
                <li>Current standings snapshot (<code>FantasySquad.total_points</code>) at run time</li>
                <li>User draft preferences (role-aware if configured)</li>
                <li>Retained players from the resolved retention phase</li>
                <li>Role snake direction: BAT/ALL first-to-last, WK/BOWL last-to-first in round 1</li>
            </ul>
            <p>The draft process will:</p>
            <ol>
                <li>Infer target squad size from each squad's current roster at run start</li>
                <li>Retain eligible boost assignments from the configured/auto retention phase</li>
                <li>Draft remaining players from teams marked as remaining in the draft window</li>
                <li>Save one run record per league/window (prevents accidental re-runs)</li>
            </ol>
            <strong>Warning: This action cannot be undone!</strong>
        </p>
    </div>
    
    <form method="post">
        {% csrf_token %}
        <fieldset class="module aligned">
            <div class="form-row">
                <label for="league_id">Select League:</label>
                <select name="league_id" id="league_id" required>
                    <option value="">---------</option>
                    {% for league in leagues %}
                    <option value="{{ league.id }}">{{ league.name }} ({{ league.season }})</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-row">
                <label for="dry_run">Dry Run:</label>
                <input type="checkbox" name="dry_run" id="dry_run" value="1">
                <span class="help">Run the draft without saving changes</span>
            </div>
            
            <div class="form-row">
                <label for="verbose">Verbose Mode:</label>
                <input type="checkbox" name="verbose" id="verbose" value="1">
                <span class="help">Show detailed draft picks in the console</span>
            </div>
        </fieldset>
        
        <div class="submit-row">
            <input type="submit" class="default" value="Run Draft">
        </div>
    </form>
</div>
{% endblock %}
